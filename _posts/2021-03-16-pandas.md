---
layout: post
title: "Pandas"
date: 2021-03-16
categories: ml
tags: ml
---

### 목차
>* [*Kaggle Course - Pandas*](https://www.kaggle.com/learn/pandas)

1. Creating, Reading and Writing
1. Indexing, Selecting & Assigning
1. Summary Functions and Maps
1. Grouping and Sorting
1. Data Types and Missing Values
1. Renaming and Combining

---

### Creating, Reading and Writing
이 튜토리얼에서는 이미 존재하는 데이터로 작업하는 방법과 함께 고유한 데이터를 만드는 방법을 배웁니다.

pandas 라이브러리를 사용하기 위해 다음과 같이 import 해줍니다.
```python
import pandas as pd
```

#### Creating data
Pandas에는 DataFrame과 Series라는 두 가지 핵심 개체가 있습니다.

<b>DataFrame</b>  
DataFrame은 테이블입니다. 여기에는 개별 항목의 배열이 포함되며 각 항목에는 특정 값이 있습니다. 각 항목은 행(또는 레코드)과 열에 해당합니다.

```python
pd.DataFrame({'Yes': [50, 21], 'No': [131, 2]})
```
```text
   Yes   No
0   50  131
1   21    2
```

위 예시에서 "0, No"항목의 값은 131입니다. "0, Yes"항목의 값은 50입니다.

```python
pd.DataFrame({'Bob': ['I liked it.', 'It was awful.'], 'Sue': ['Pretty good.', 'Bland.']})
```
```text
             Bob           Sue
0    I liked it.  Pretty good.
1  It was awful.        Bland.
```
DataFrame 항목은 정수로 제한되지 않습니다.

우리는 이러한 DataFrame 객체를 생성하기 위해 pd.DataFrame() 생성자를 사용하고 있습니다. 새로운 것을 선언하는 구문은 키가 열 이름(이 예시에서는 Bob, Sue)이고 값이 항목 목록인 사전입니다. 이것은 새로운 DataFrame을 구성하는 표준적인 방법이며 앞으로 가장 많이 접하게 될 것입니다.

사전 목록 생성자는 열 레이블에 값을 할당하지만 행 레이블에 대해 0(0, 1, 2, 3, ...)부터 오름차순 개수만 사용합니다. 상관없을수도 있지만, 우리는 이러한 레이블을 직접 할당하고 싶을 때도 있을겁니다.

DataFrame에서 사용되는 행 레이블 목록을 인덱스(Index)라고합니다. 생성자에서 index 매개 변수를 사용하여 값을 할당 할 수 있습니다.

```python
pd.DataFrame(
    {
        'Bob': ['I liked it.', 'It was awful.'], 
        'Sue': ['Pretty good.', 'Bland.']
    },
    index=['Product A', 'Product B']
)
```
```text
                     Bob           Sue
Product A    I liked it.  Pretty good.
Product B  It was awful.        Bland.
```

<b>Series</b>  
대조적으로 Series는 일련의 데이터 값입니다. DataFrame이 테이블이면 Series는 목록입니다.
```python
pd.Series([1, 2, 3, 4, 5])
```
```text
0    1
1    2
2    3
3    4
4    5
dtype: int64
```

Series는 본질적으로 DataFrame의 단일 열입니다. 따라서 DataFrame처럼 index 매개 변수를 사용하여 Series에 열 값을 할당 할 수 있습니다. 그러나 시리즈에는 열 이름이 없고 하나의 전체 이름만 있습니다.
```python
pd.Series([30, 35, 40], index=['2015 Sales', '2016 Sales', '2017 Sales'], name='Product A')
```
```text
2015 Sales    30
2016 Sales    35
2017 Sales    40
Name: Product A, dtype: int64
```
Series와 DataFrame은 밀접하게 관련되어 있습니다. DataFrame을 실제로 "함께 묶인" Series로 생각하면 도움이됩니다.

#### Reading data files
DataFrame 또는 Series를 직접 만들 수 있으면 편리합니다. 그러나 대부분의 경우 실제로 직접 데이터를 직접 생성하지는 않습니다. 대신 이미 존재하는 데이터로 작업 할 것입니다.

데이터는 다양한 모양과 포멧으로 저장할 수 있습니다. 가장 기본적인 것은 csv 파일입니다. csv 파일을 열면 다음과 같은 결과가 나타납니다.
```text
Product A,Product B,Product C,
30,21,9,
35,34,1,
41,11,11
```

csv 파일은 쉼표로 구분 된 값 테이블입니다.
이제 dataset를 따로 설정하고 DataFrame으로 읽을 때 실제 dataset가 어떻게 보이는지 살펴 보겠습니다. pd.read_csv() 함수를 사용하여 데이터를 DataFrame으로 읽어들입니다.

>* [*winemag-data-130k-v2.csv*](https://www.kaggle.com/christopheiv/winemagdata130k?select=winemag-data-130k-v2.csv)

```python
wine_reviews = pd.read_csv("input_data/winemag-data-130k-v2.csv")
```

shape 속성을 사용하여 결과 DataFrame의 크기를 확인할 수 있습니다.
```python
wine_reviews.shape
```
```text
(129971, 14)
```

따라서 새로운 DataFrame에는 14개의 다른 열로 분할 된 약 130,000개의 레코드가 있습니다. 거의 2백만 개의 항목입니다!

처음 5개 행을 가져 오는 head() 명령을 사용하여 결과 DataFrame의 내용을 검사 할 수 있습니다.
```python
wine_reviews.head()
```
```text
   Unnamed: 0   country  ...         variety               winery
0           0     Italy  ...     White Blend              Nicosia
1           1  Portugal  ...  Portuguese Red  Quinta dos Avidagos
2           2        US  ...      Pinot Gris            Rainstorm
3           3        US  ...        Riesling           St. Julian
4           4        US  ...      Pinot Noir         Sweet Cheeks

[5 rows x 14 columns]
```

pd.read_csv() 함수는 사용자가 30개 이상의 선택적 매개 변수와 함께 사용할 수 있습니다. 예를 들어 이 dataset에는 csv 파일에 기본 제공 index가 있지만 pandas가 자동으로 인식하지 못 했습니다. 이 때, pandas가 index로 해당 열을 사용하도록 만들기 위해 index_col을 지정할 수 있습니다.
```python
wine_reviews = pd.read_csv("input_data/winemag-data-130k-v2.csv", index_col=0)
wine_reviews.head()
```
```text
    country  ...               winery
0     Italy  ...              Nicosia
1  Portugal  ...  Quinta dos Avidagos
2        US  ...            Rainstorm
3        US  ...           St. Julian
4        US  ...         Sweet Cheeks

[5 rows x 13 columns]
```

---

### Indexing, Selecting & Assigning
#### Native accessors
네이티브 Python 개체는 데이터를 인덱싱하는 좋은 방법을 제공합니다. Pandas는 이 모든 것을 전달하므로 쉽게 시작할 수 있습니다.
```python
import pandas as pd
reviews = pd.read_csv("input_data/winemag-data-130k-v2.csv", index_col=0)
pd.set_option('max_rows', 5)

reviews
```
```text
         country  ...                winery
0          Italy  ...               Nicosia
1       Portugal  ...   Quinta dos Avidagos
...          ...  ...                   ...
129969    France  ...  Domaine Marcel Deiss
129970    France  ...      Domaine Schoffit

[129971 rows x 13 columns]
```

Python dictionary가 있으면 색인 ([]) 연산자를 사용하여 값에 액세스 할 수 있습니다. DataFrame의 열에 대해 동일한 작업을 수행 할 수 있습니다.
```python
reviews['country']
```
```text
0            Italy
1         Portugal
            ...   
129969      France
129970      France
Name: country, Length: 129971, dtype: object
```

```python
reviews['country'][0]
```
```text
'Italy'
```

#### Indexing in pandas
<b>Index-based selection</b>  
Pandas 인덱싱에는 두 가지 패러다임이 있습니다. 첫 번째는 인덱스 기반 선택입니다. 데이터의 숫자 위치에 따라 데이터를 선택합니다. iloc은 이 패러다임을 따릅니다.

DataFrame에서 데이터의 첫 번째 행을 선택하려면 다음을 사용할 수 있습니다.
```python
reviews.iloc[0]
```
```text
country                                                    Italy
description    Aromas include tropical fruit, broom, brimston...
                                     ...                        
variety                                              White Blend
winery                                                   Nicosia
Name: 0, Length: 13, dtype: object
```

(계속)